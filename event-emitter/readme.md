# Банковский аккаунт на EventEmitter


## Задача 1

Реализовать модуль управления банком.

```js

const bank = new Bank();

const personId = bank.register({
	name: 'Pitter Black',
	balance: 100
});

bank.emit('add', personId, 20);
bank.emit('get', personId, (balance) => {
	console.log(`I have ${balance}₴`); // I have 120₴
});
bank.emit('withdraw', personId, 50);
bank.emit('get', personId, (balance) => {
	console.log(`I have ${balance}₴`); // I have 70₴
}
```

1. Реализовать метод **register** который будет регистрировать нового контрагента. Метод возвращает идентификатор контрагента (генерируется автоматически модулем Bank).

```
{
	name*: String, 		// имя контрагента
	balance*: Number  // начальный баланс
}
```

2. Реализовать поддержку события **add** которое принимает идентификатор контрагента в качестве второго аргумента и сумму зачисления в качестве третьего аргумента. Событие должно добавить деньги на счёт клиенту.
3. Реализовать поддержку события **get** которое принимает идентификатор контрагента в качестве второго аргумента и колбек функцию в качестве третьего аргумента. Сallback принимает один аргумент **balance**, который указывает на количество денег на момент генерации события.
4. Реализовать поддержку события **withdraw** которое принимает идентификатор контрагента в качестве второго аргумента и сумму списания в качестве третьего аргумента. Событие должно списать деьги со счёта контрагента.

##### Обратите внимание!
1. Метод **register** должен вызывать ошибку при попытке добавления двух контрагентов с одинаковыми именами.
2. Метод **register** должен вызывать ошибку при попытке добавления контрагента со значением **balance** меньше или равным нулю.
3. Событие **add** должно генерировать ошибку при попытке зачислить отрицательную или нулевую сумму на счёт контрагента.
4. Событие **withdraw** должно генерировать ошибку при попытке списать отрицательную сумму со счёта контрагента.
5. Событие **withdraw** должно генерировать ошибку при попытке списать сумму со счёта контрагента если после списания счёт контрагента будет меньше нуля.
6. Все события должны генерировать ошибку если им передан не существующий идентификатор контрагента.
7. Генерирование и обработку ошибок необходимо реализовать при помощи события
**error**.

```
.emit('error');
.on('error')
```


## Задача 2

Доработать задачу с задания #1

```js
const bank = new Bank();

const personFirstId = bank.register({
	name: 'Pitter Black',
	balance: 100
});

const personSecondId = bank.register({
	name: 'Oliver White',
	balance: 700
});

bank.emit('send', personFirstId, personSecondId, 50);
bank.emit('get', personSecondId, (balance) => {
	console.log(`I have ${balance}₴`); // I have 750₴	
});
```

1. Реализовать событие **send** которое будет принимать идентификатор контрагента который переводит деньги в качестве второго аргумента и идентификатор контрагента который получает деньги в качестве третьего контрагента. В качестве четвёртого аргмуента будет указана сумма перевода.

##### Обратите внимание!
1. Событие **send** должно генерировать ошибку если сумма перевода меньше или равна нулю.
2. Событие **send** должно генерировать ошибку если переданы не существующие идентификаторы.


## Задача 3

Доработать задачу с задания #2 и реализовать лимит на перевод денег.

```js
const bank = new Bank();

const personId = bank.register({
	name: 'Oliver White',
	balance: 700,
	limit: amount => amount < 10
});

bank.emit('withdraw', personId, 5);
bank.emit('get', personId, (amount) => {
	console.log(`I have ${amount}₴`); // I have 695₴
});

// Вариант 1
bank.emit('changeLimit', personId, (amount, currentBalance, updatedBalance) => {
	return amount < 100 && updatedBalance > 700;
});
bank.emit('withdraw', personId, 5); // Error

// Вариант 2
bank.emit('changeLimit', personId, (amount, currentBalance, updatedBalance) => {
	return amount < 100 && updatedBalance > 700 && currentBalance > 800;
});

// Вариант 3
bank.emit('changeLimit', personId, (amount, currentBalance) => {
	return currentBalance > 800;
});

// Вариант 4
bank.emit('changeLimit', personId, (amount, currentBalance, updatedBalance) => {
	return updatedBalance > 900;
});
```

1. Событие **send** должно генерировать ошибку если сумма перевода контрагента не удовлетворяет проверку описанную в **limit**.
2. Событие **withdraw** должно генерировать ошибку если сумма перевода контрагента не удовлетворяет проверку описанную в **limit**.
3. Событие **changeLimit** должно устанавливать новый колбек. Событие **changeLimit** принимает идентификатор контрагента в качестве второго аргумента и колбек функцию в качестве третьего аргумента.
4. Аргумент колбека в событии **changeLimit**, **amount** — это количество денег которое нужно перевести на счёт другого контрагента или снять со счёта.
5. Аргумент колбека в событии **changeLimit**, **currentBalance** — это количество денег которое есть на текущий момент на счету контрагента.
6. Аргумент колбека в событии **changeLimit**, **updatedBalance** — это количество денег которое будет на счету контрагента в случае успешной транзакции.

##### Например
Допустим вы хотите снимать или переводить суммы которые в рамках одного события меньше 100 и при этом не хотите чтобы баланс после транзакции стал меньше 700.

Для решения этой задачи вам необходимо вызвать событие **changeLimit** и передать ему колбек описывающий необходимую проверку (Вариант 1). После вызова события **changeLimit** все последующие вызовы события **send** или **withdraw** должны проходить проверку описанную в колбек функции.

##### Обратите внимание!
1. Генерирование и обработку ошибок необходимо реализовать при помощи события error

```
.emit('error');
.on('error')
```

Автор задания: Андрей Присняк (Lectrum Education)